<div class="modal-header">
  <button type="button" class="close" ng-click="close()">&times;</button>
  <h4 class="modal-title">Configure Offer <span class="text-muted italic">- Please select a product from each group</span></h4>
</div>

<div class="modal-body queue-modal-body">

  <div class="row">
    <div class="col-lg-3 col-md-3 col-sm-3 kitSelections">
      <aside id="shop_menu">
        <ul>
          <li id="kitGroupNav{{kitGroup.kitGroup.id}}" ng-repeat="kitGroup in item.product.kitGroups" ng-click="kitGroupClicked(kitGroup)">
            <a href="" ng-class="{'active': isKitGroupSelected(kitGroup.kitGroup)}">
              <span class="ng-binding kitGroupNavName">{{kitGroup.kitGroup.id}}</span>
              <i ng-if="isKitGroupSelected(kitGroup.kitGroup)" class="fa fa-angle-up pull-right ng-scope"></i>
              <i ng-if="!isKitGroupSelected(kitGroup.kitGroup)" class="fa fa-angle-down pull-right ng-scope"></i>
            </a>
            <!--{{item.kitSelections[kitGroup.kitGroup.id]}} {{productIdToProduct}}-->
            <span class="modal-addon-item product-image" ng-if="item.kitSelections[kitGroup.kitGroup.id] != null && productIdToProduct != null">
              <p class="product-name">{{productIdToProduct[item.kitSelections[kitGroup.kitGroup.id].sku]['name_'+$rootScope.session.language]}}</p>
              <img ng-if="productIdToProduct[item.kitSelections[kitGroup.kitGroup.id]].images > 0" class="img-responsive" ng-src="{{productIdToProduct[item.kitSelections[kitGroup.kitGroup.id]].images[0].imagePath}}">
              <img ng-if="productIdToProduct[item.kitSelections[kitGroup.kitGroup.id]].images == 0" class="img-responsive" ng-src="/img/product_placeholder.gif">
            </span>
          </li>
        </ul>
      </aside>
      <!--<img class="img-responsive" ng-src="/{{getImagePath(product.images[0].imagePath)}}">-->
      <!--<p class="modal-addon-item-title">{{product.name}}</p>-->
    </div>
    <div class="col-lg-9 col-md-9 col-sm-9 kitSelectionList">
      <form name="kitSelectionForm" role="form" class="form-inline clearfix">
        <div ng-repeat="kitGroup in item.product.kitGroups">
          <div id="kitGroup{{kitGroup.kitGroup.id}}" class="ng-binding kitnameWrapper">
            <span class="kitname">{{kitGroup.kitGroup.id}}</span>
            <span ng-if="$index > 0" class="pull-right"><a href="" ng-click="kitGroupClicked(item.product.kitGroups[$index-1].kitGroup)">Back to {{item.product.kitGroups[$index-1].kitGroup.id}}</a></span>
          </div>
          <!-- products in kitgroup -->
          <div class="row" ng-repeat="component in kitGroup.kitGroup.components">
            <div ng-if="productIdToProduct[component.product]" class="col-lg-3 col-md-3 col-xs-6 col-sm-4 modal-addon-item product-image" ng-class="{'selected': item.kitSelections[kitGroup.kitGroup.id].sku == component.product}">
              <img ng-if="productIdToProduct[component.product].images.length > 0" class="img-responsive" ng-src="{{getImagePath(productIdToProduct[component.product].images[0].imagePath)}}" ng-click="selectProduct(kitGroup.kitGroup.id, component.product)">
              <img ng-if="productIdToProduct[component.product].images.length == 0" class="img-responsive" ng-src="/img/product_placeholder.gif" ng-click="selectProduct(kitGroup.kitGroup.id, component.product)">
              <span ng-if="item.kitSelections[kitGroup.id].sku != component.product" class="kit-selection-plus">+</span>
              <i ng-if="item.kitSelections[kitGroup.id].sku == component.product" class="kit-selection-check fa fa-check"></i>
            </div>
            <div ng-if="productIdToProduct[component.product]" class="col-lg-9 col-md-9 col-xs-6 col-sm-8 modal-addon-item">
              <p class="modal-addon-item-title">{{productIdToProduct[component.product]['name_'+$rootScope.session.language]}}</p>
              <p class="modal-addon-item-description" ng-bind-html="productIdToProduct[sku].description | unsafe">Product description</p>
              <p class="modal-addon-item-quantity"><span ng-bind-html="'QUANTITY' | translate | unsafe"></span>: {{productIdToProduct[component.product].quantity}}</p>
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>
<div class="modal-footer">
  <div class="col-lg-6 col-md-6 col-sm-6">
    <span class="text-muted pull-left"><span ng-bind-html="'CHOOSE-OPTION-AND-SAVE-TITLE' | translate | unsafe"></span></span>
  </div>
  <div class="col-lg-6 col-md-6 col-sm-6">
    <button ng-click="close()" class="btn btn-link"><span ng-bind-html="'BTN_CANCEL' | translate | unsafe"></span></button>
    <button ng-click="save()" class="btn btn-primary" ng-show="isKitSelectionComplete()"><i class="fa fa-shopping-cart"></i> <span ng-bind-html="'BTN_SAVE_CART' | translate | unsafe"></span></button>
    <button ng-click="save()" class="btn btn-primary" ng-show="!isKitSelectionComplete()" disabled="disabled"><i class="fa fa-shopping-cart"></i> <span ng-bind-html="'BTN_SAVE_CART' | translate | unsafe"></span></button>
  </div>
</div>
